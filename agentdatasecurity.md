# Data Security in LLM Agents and Agentic Applications

```mermaid
flowchart TD
    %% Define Colors
    classDef dataSources fill:#FFDDC1,stroke:#FF7F50,stroke-width:2px;
    classDef agent fill:#FFF3CD,stroke:#FFC107,stroke-width:2px;
    classDef inference fill:#D4EDDA,stroke:#28A745,stroke-width:2px;
    classDef risks fill:#F8D7DA,stroke:#DC3545,stroke-width:2px;
    classDef mitigations fill:#CCE5FF,stroke:#007BFF,stroke-width:2px;

    %% Legend
    subgraph Legend [Color Coding Labels]
        legend1[**Orange**: Data Sources]:::dataSources
        legend2[**Yellow**: Agent Processes]:::agent
        legend3[**Green**: Inference Systems and Pipelines]:::inference
        legend4[**Red**: Vulnerabilities and Risks]:::risks
        legend5[**Blue**: Monitoring and Mitigation Strategies]:::mitigations
    end

    %% Data Sources
    A[Training Data Sources]:::dataSources
    A1[Structured Data: JSON]:::dataSources --> A
    A2[Unstructured Data: Text]:::dataSources --> A
    A3[Sensitive Data: PII]:::dataSources --> A
    A -->|Processed| B[Model Weights\nGenerated by Training]:::inference

    %% Agentic Application Flow
    B -->|Deployed in| C[LLM Agents\nReasoning & Decision-Making]:::agent
    C -->|Data Retrieval| D[External Data Sources:\nAPIs and Databases]:::dataSources
    C -->|Decision Outputs| E[Actions via Tools and APIs]:::agent
    D -->|Retrieved Context| C
    E -->|Feedback| F[Model Updates\nor Fine-Tuning]:::inference

    %% Vulnerabilities
    B -->|Model Inference Attacks| V1[Data Extraction\nvia Prompt Injection]:::risks
    C -->|Over-Permissioned Agents| V2[Tool Misuse\nor API Abuse]:::risks
    D -->|Data Poisoning| V3[External Data Manipulation]:::risks
    E -->|Action Injection| V4[Unauthorized Actions\nvia Agent Exploits]:::risks
    F -->|Data Contamination| V5[Corrupted Updates]:::risks

    %% Mitigations
    subgraph Mitigation Strategies
        M1[Data Encryption & Access Control]:::mitigations
        M2[Content Filters & Guardrails]:::mitigations
        M3[Permissioning Systems for Tools/APIs]:::mitigations
        M4[Data Validation Pipelines]:::mitigations
        M5[Monitoring Tools for Anomaly Detection]:::mitigations
        M6[Fine-Grained Logging & Traceability]:::mitigations
    end

    %% Link Risks to Mitigations
    V1 -->|Encryption & Validation| M1
    V1 -->|Content Filtering| M2
    V2 -->|Tool Permissions| M3
    V3 -->|Data Validation| M4
    V4 -->|Action Auditing| M6
    V5 -->|Monitoring| M5

    %% Class Assignments
    class A,A1,A2,A3,D dataSources;
    class B,C,E,F agent;
    class V1,V2,V3,V4,V5 risks;
    class M1,M2,M3,M4,M5,M6 mitigations;
